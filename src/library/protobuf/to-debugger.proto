syntax = "proto3";

package fdbg;

enum Status {
  OK = 0;
  ERR_WRITING_MEMORY = 1;
  TOO_MANY_BREAKPOINTS = 2;
}

message AckResponse {
  uint32 id = 1;
}

message WriteMemoryResponse {
  uint64 first_failed_pos = 1;
}

message ReadMemoryResponse {
  uint64 initial_pos = 1;
  bytes  bytes       = 2;
};

message ComputerStatus {
  uint64          pc        = 1;   // program counter
  repeated uint64 registers = 2;
  repeated bool   flags     = 3;
  bytes           stack     = 4;
};

message BreakpointList {
  repeated uint64 addr = 1;
};

message ToDebugger {
  Status status = 1;
  oneof message {
    AckResponse         ack_response          = 2;
    WriteMemoryResponse write_memory_response = 3;
    ReadMemoryResponse  read_memory_response  = 4;
    ComputerStatus      computer_status       = 5;
    BreakpointList      breakpoint_list       = 6;
  }
}